<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo List App</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      function Header() {
        return (
          <header>
            <h1>Todo List - React 기능 추가</h1>
            <p>
              파일 경로:
              <span id="filepath">
                {`ch${document.URL.split("/ch")[1]}index.html`}
              </span>
            </p>
          </header>
        );
      }

      function TodoInput({ addItem }) {
        const [title, setTitle] = React.useState("");
        const [nextId, setNextId] = React.useState(4);

        const handleAdd = () => {
          if (title.trim() !== "") {
            const item = { _id: nextId, title, done: false };
            addItem(item);
            setNextId(nextId + 1);
            setTitle("");
          }
        };

        const handleKyeUp = (event) => {
          if (event.key === "Enter") handleAdd();
        };

        return (
          <div className="todoinput">
            <input
              type="text"
              autoFocus
              onKeyUp={(event) => handleKyeUp(event)}
              value={title}
              onChange={(event) => setTitle(event.target.value)}
            />
            <button type="button" onClick={handleAdd}>
              추가
            </button>
          </div>
        );
      }

      function TodoItem({ item }) {
        return (
          <li>
            <span>{item._id}</span>
            <span>{item.done ? <s>{item.title}</s> : item.title}</span>
            <button type="button">삭제</button>
          </li>
        );
      }

      function TodoList({ itemList }) {
        const list = itemList.map((item) => (
          <TodoItem key={item._id} item={item} />
        ));
        return <ul className="todolist"> {list} </ul>;
      }

      function Todo(props) {
        return (
          <div id="main">
            <div id="container">
              <ul>
                <li>
                  <h2>쇼핑 목록</h2>
                  <TodoInput addItem={props.addItem} />
                  <TodoList itemList={props.itemList} />
                </li>
              </ul>
            </div>
          </div>
        );
      }

      function Footer() {
        return (
          <footer>
            <p>멋쟁이 사자처럼 FrontEnd BootCamp</p>
          </footer>
        );
      }

      function App() {
        // 샘플 목록
        const [itemList, setItemList] = React.useState([
          { _id: 1, title: "두부", done: true },
          { _id: 2, title: "계란", done: false },
          { _id: 3, title: "라면", done: true },
        ]);

        const addItem = (item) => {
          const newItemList = [...itemList, item]; // 객체의 경우에는 그 안의 속성과 값만 바꾸는게 아니라 새로운 객체를 만들어줘야 주소가 달라져서 업데이트 가능
          setItemList(newItemList); // setter 함수를 통해 화면을 갱신
        };

        return (
          <div id="todo">
            <Header />
            <Todo itemList={itemList} addItem={addItem} />
            <Footer />
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
